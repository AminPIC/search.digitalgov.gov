<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Page 10 of USASearch Blog</title>
  <meta name="description" content="">
  <meta name="author" content="">

  <link href="/bootstrap/css/bootstrap.css" rel="stylesheet">
  <link rel="stylesheet" href="/stylesheets/font-awesome.min.css">
  <!--[if IE 7]>
  <link rel="stylesheet" href="/stylesheets/font-awesome-ie7.min.css">
  <![endif]-->

  <style>
    body {
      padding-top: 60px;
    }
  </style>
  <!--<link href="../assets/css/bootstrap-responsive.css" rel="stylesheet">-->
  <link href="/stylesheets/custom.css" rel="stylesheet">

  <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
  <script src="/javascripts/html5shiv.js"></script>
  <![endif]-->

  <!-- Fav and touch icons -->
  <!--  <link rel="apple-touch-icon-precomposed" sizes="144x144"
          href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114"
          href="../assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72"
          href="../assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">-->
  <link rel="shortcut icon" href="http://f22818b4dfc10241d8a3-f1564c64756a8cfee25b6b19953b1d23.r31.cf2.rackcdn.com/favicon.ico">
</head>
<body>
<div class="navbar navbar-inverse navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="/"><span class="usa">USA</span><span class="search">Search</span></a>
      <ul class="nav">
        <li><a href="/customers.html">Testimonials</a></li>
        <li><a href="/developer/index.html">APIs</a></li>
        <li><a href="/help-desk.html">Help Desk</a></li>
      </ul>
      <ul class="nav">
        <li>
          <form class="form-search" accept-charset="UTF-8" action="http://search.usa.gov/search"
                id="search-form" method="get">
            <input id="affiliate" name="affiliate" type="hidden" value="usasearch"/>

            <div class="input-append">
              <label for="search-query" class="hide">Query</label>
              <input name="query" type="text" autocomplete="off"
                     class="usagov-search-autocomplete span search-query" id="search-query"/>
              <input type="submit" class="btn" id="search-button">Search</input>
            </div>
          </form>
        </li>
      </ul>
      <ul class="nav login">
        <li>
          <a href="http://search.usa.gov/affiliates/home"><i
              class="icon-user icon-white"></i>&nbsp;Login</a>
        </li>
      </ul>
    </div>
  </div>
</div>

<div class="container">
  <div id="main-container">
    

<!-- begin paginate layout -->
<div class='articles'>
  
  <article class='article'>
    <div class='time'>
      <a href="/blog/june-release-notes-happy-fourth-of-july.html">
        <time>July 1, 2011</time>
      </a>
    </div>

    
    <h1>
      <a href="/blog/june-release-notes-happy-fourth-of-july.html">June Release Notes & Happy Fourth of July</a>
    </h1>
    

    <div class='post-content'>
      <p><span><span>The USASearch Team wishes everyone a safe and happy Fourth of July. Before everyone departs for the long holiday, we wanted to post our June release notes.</span><br/></span></p>
<p>As a reminder, we divide our work into three categories:</p>
<p>1) Features — things that you actually notice<br/>2) Bugs — Fixes to any code issues that may arise <br/>3) Chores — back-end improvements that you don’t notice </p>
<p>Features:</p>
<p>For End Users Users:</p>
<ul><li>Users see polished agency GovBox design</li>
<li>Users see aligned text on SERPs</li>
<li>Users don’t see underlines on SERPs</li>
<li>User sees health GovBoxes</li>
<li>Users have improved accessibility for USASearch Program pages</li>
<li>Users see consistently-aligned items on landing pages</li>
<li>Users see added agency popular url model incl govbox view</li>
<li>Users see PDF before serp result titles for pdf urls</li>
<li>Users see improved basic_gray search term highlite visibility and removed</li>
<li>Mobile users can see SMS option</li>
<li>Spanish searchers can find web and imagenes landing pages</li>
</ul><p>For Admins:</p>
<ul><li>USAAdmins can easily batch process new users by status</li>
<li>Analysts see 4 column daily click module containing module name, impressions, clicks, and CTR% </li>
</ul><p>Fixes:</p>
<ul><li>Users should not have letters “skipped” as they’re typing in the search box</li>
<li>Display shorter URLs on Affiliate SERPs</li>
<li>Affiliates should not see global terms populated in type ahead</li>
<li>Update API language</li>
<li>Fix type ahead suggestion drop down and font size in Grey Template</li>
<li>Modify indices on agency_urls</li>
<li>Boosted Sites/Spotlights/GovBoxes don’t have proper precedence rules.</li>
<li>HTML shows up on affiliate confirmation screen</li>
<li>Users don’t see web vertical spotlights on forms vertical</li>
<li>Search users should be able to see SAYT dropdown</li>
<li>Users get page not found error when logging out from some program/admin pages</li>
</ul><p><em>By Erik</em></p>

    </div>

    <div class='tags'>
      
      <a href="/tagged/releases"><span class="label label-info">releases</span></a>
      
    </div>
  </article>
  
  <article class='article'>
    <div class='time'>
      <a href="/blog/all-sites-need-strong-sophisticated-search.html">
        <time>June 22, 2011</time>
      </a>
    </div>

    

    <div class='post-content'>
      All sites need strong sophisticated search functionality, because they have more content than ever before.
<p><a href="http://www.forrester.com/rb/Research/site_search_evolves_from_technical_feature_to/q/id/58698/t/2">Site Search Evolves From Technical Feature To Customer Touchpoint: Results From Forrester’s Q1&#160;2011 Site Search Online Survey</a></p>

    </div>

    <div class='tags'>
      
      <a href="/tagged/research-and-news"><span class="label label-info">research-and-news</span></a>
      
    </div>
  </article>
  
  <article class='article'>
    <div class='time'>
      <a href="/blog/adopting-apache-hadoop-in-the-federal-government.html">
        <time>June 16, 2011</time>
      </a>
    </div>

    
    <h1>
      <a href="/blog/adopting-apache-hadoop-in-the-federal-government.html">Adopting Apache Hadoop in the Federal Government</a>
    </h1>
    

    <div class='post-content'>
      <p><strong>Background</strong></p>
<p>The United States federal government’s <a href="http://search.usa.gov/program" target="_blank">USASearch program</a> provides hosted search services for government affiliate organizations, shares APIs and web services, and operates the government’s official search engine at Search.USA.gov. The USASearch <a href="https://search.usa.gov/affiliates/how_it_works" target="_blank">affiliate program</a> offers free search services to any federal, state, local, tribal, or territorial government agency. Several hundred websites make use of this service, ranging from the smallest municipality to larger federal sites like <a href="http://weather.gov" target="_blank">weather.gov</a> and <a href="http://usa.gov" target="_blank">usa.gov</a>. The USASearch program leverages the Bing API as the basis for its web results and then augments the user search experience by providing a variety of government-centric information such as related search topics and highlighted editorial content. The entire system is comprised of a suite of open-source tools and resources, including Apache Solr/Lucene, OpenCalais, and Apache Hadoop. Of these, our usage of Hadoop is the most recent. We began using <a href="http://www.cloudera.com/hadoop/" target="_blank">Cloudera’s Distribution including Apache Hadoop</a> (<a href="http://www.cloudera.com/hadoop" target="_blank">CDH3</a>) for the first time in the Fall, and since then we’ve seen our usage grow every month— not just in scale, but in scope as well. But before highlighting everything the USASearch program is doing with Hadoop today, I should explain why we began using it in the first place.</p>
<p><strong>Phase 1: Search analytics</strong></p>
<p>All of the search and <a href="http://search.usa.gov/api" target="_blank">API</a> traffic across hundreds of affiliate sites, iPhone apps, and widgets comes through a single search service, and this generates a lot of data. To improve the service, administrators wanted to see aggregated information on what sorts of information searchers were looking for, how well they were finding it, what trends were forming, and so on. Once searches were initiated, they also wanted to know what results were shown and then what results were clicked on. They wanted to see all this information broken down by affiliate over time, and also aggregated across the entire affiliate landscape.</p>
<p>The initial system, like many initial systems, was fairly simple and did just enough to address our most pressing analytics needs. We took the logs from Apache and Ruby on Rails, put them in a big MySQL database on a separate machine, ran nightly and monthly jobs on them, and then exported the summary results to the main database cluster to be served up via a low-latency Rails web interface for analytics. We used a separate physical database machine with lots of memory and disk for the batch processing to keep our production MySQL instances from being impacted by this resource-intensive batch processing.</p>
<p><img class="img-polaroid" class="img-polaroid" alt="Diagram showing the initial dataflow of raw logfiles to analytics apps" src="http://f22818b4dfc10241d8a3-f1564c64756a8cfee25b6b19953b1d23.r31.cf2.rackcdn.com/tumblr_lle73iJ2Ts1qid15q.png"/></p>
<p>As we watched the main database tables grow and the nightly batch jobs take longer and longer, it became clear that we would soon exhaust the resources available on the single database analytics processing node. We looked at scaling up the hardware vertically and sharding the database horizontally, but both options seemed like we were just kicking the can down the road. Larger database hardware would be both costly and eventually insufficient for our needs, and sharding promised to take all the usual issues associated with a single database system (backups, master/slaves, schema management) and multiply them. We wanted the system to be able to grow cost effectively and without downtime, be naturally resilient to failures, and have backups handled sensibly. It was at this point that we started investigating HDFS, Hadoop, and Apache Hive.</p>
<p>HDFS offered us a distributed, resilient, and scalable filesystem while Hadoop promised to bring the work to where the data resided so we could make efficient use of local disk on multiple nodes. Hive, however, really pushed our decision in favor of a Hadoop-based system. Our data is just unstructured enough to make traditional RDBMS schemas a bit brittle and restrictive, but has enough structure to make a schema-less NoSQL system unnecessarily vague. Hive let us compromise between the two— it’s sort of a “SomeSQL” system.</p>
<p>But best of all, we could layer the entire Cloudera stack on top of a subset of our existing production machines. By making use of each machine’s excess reserve capacity of disk, CPU, and RAM, we were able to get a small proof-of-concept cluster stood up without purchasing any new hardware. The initial results confirmed that our workload lent itself well to distributed processing, as one job went from taking over an hour on a MySQL node to 20 minutes on a three machine Hadoop cluster. Within a week of getting the prototype up and running, we had transitioned all the remaining nightly analytics batch SQL jobs into Hive scripts. The job output fed into a collection of intermediate Hive tables, from which we generated summary data to export to MySQL as low-latency tables for the Rails web interface to use. To prove the scaling point, we spent five minutes adding another datanode/tasktracker to the mix, kicked off the cluster rebalancer, and the whole process ran faster the next day.</p>
<p><img class="img-polaroid" class="img-polaroid" alt="Diagram showing the current dataflow of raw logfiles to analytics apps" src="http://f22818b4dfc10241d8a3-f1564c64756a8cfee25b6b19953b1d23.r31.cf2.rackcdn.com/tumblr_lle73rea1K1qid15q.png"/></p>
<p><strong>Phase 2: Feedback loop</strong></p>
<p>The result of all this analysis in Hive shows up not just in various analytics dashboards, but as part of the search experience on many government websites, too. For example, compare the different type-ahead suggestions for ‘<strong>gran</strong>’ on <a href="http://nps.gov/">nps.gov</a> and <a>usa.gov</a>. Both sites use the same USASearch backend system, but the suggestions differ completely. We use Hadoop to help us generate contextually relevant and timely search suggestions for hundreds of government sites like this.</p>
<p><img class="img-polaroid" class="img-polaroid" alt="Image showing different type-ahead suggestions on NPS.gov and USA.gov" src="http://f22818b4dfc10241d8a3-f1564c64756a8cfee25b6b19953b1d23.r31.cf2.rackcdn.com/tumblr_lle73ymed31qid15q.png"/></p>
<p><strong>Phase 3: Internal monitoring</strong></p>
<p>Shortly after moving our event stream analysis from MySQL to Hadoop/Hive, we noticed a change in how we thought about data. Freed from the constant anxiety of wondering how we were going to handle an ever-increasing amount of data, we shifted from trying to store only what we really needed to storing whatever we thought might be useful. We first turned our attention to the performance data emitted by the various sub-systems that make up the search program.</p>
<p>Each search results page is potentially made up of many data modules sintered together from calls to the Bing API, our own Solr indexes, a MySQL cluster, and a Redis cache. A small latency problem with any one of them can propagate through the system to create much larger problems, so we want to have a deep knowledge of how each subsystem behaves throughout the day under various circumstances. We were already monitoring the availability of all these services with Opsview, but we had no insight into their performance over time. Whenever we sensed a problem (“Is one of the Solr indexes getting slow?”), we would liberally apply ssh, tail -f, and grep to try to see what was going on. This seemed like a good use case for Hive, so in the case of Solr, for example, we threw the compressed log files into HDFS, wrote a simple SerDe regular expression to define rows in a Hive table partitioned by date, and built a view on top of that for easy manipulation of extracted columns such as the Solr index name and the hour of day. Hive makes it trivially easy to do some fairly sophisticated aggregate analysis on the response times for each Solr index, such as generating a distribution histogram, or calculating the pth percentile.</p>
<p>Some of these Hive queries are not run very often— perhaps just a few times a month— so we don’t want to spend time building them into our test-driven Rails analytics framework. On the other hand, they are complex enough that we don’t want to rewrite them every time we want to use them. For these cases, we use Beeswax in HUE to save off parameterized queries that can then be shared among engineers or analysts to run on an ad hoc basis.</p>
<p><strong>Conclusion</strong></p>
<p>In the space of a few months, we’ve gone from having a brittle and hard-to-scale RDBMS-based analytics platform to a much more agile Hadoop-based system that was designed to scale intrinsically. We continue to see our Hadoop usage grow in scope with each new data source we add, and it’s clear that we’ll be relying on it more and more in the future as the suite of tools and resources around Hadoop grows and matures.</p>
<p><em>By Loren</em></p>
<p><em><strong>This post is cross-posted from <a href="http://www.cloudera.com/blog/2011/04/adopting-apache-hadoop-in-the-federal-government/" title="Cloudera">Cloudera</a>.</strong></em></p>

    </div>

    <div class='tags'>
      
      <a href="/tagged/analytics"><span class="label label-info">analytics</span></a>
      
      <a href="/tagged/big-data"><span class="label label-info">big-data</span></a>
      
    </div>
  </article>
  
  <article class='article'>
    <div class='time'>
      <a href="/blog/congratulations-to-mary-sue-deffily-program.html">
        <time>June 9, 2011</time>
      </a>
    </div>

    

    <div class='post-content'>
      <img
    src="http://f22818b4dfc10241d8a3-f1564c64756a8cfee25b6b19953b1d23.r31.cf2.rackcdn.com/tumblr_lmjaf8ug2X1qk616po1_1280.jpg"
    alt="Congratulations to Mary Sue Deffily, Program Manager, USASearch Program, GSA for winning the AFFIRM Leadership Award for Innovative Applications  Presented for superior leadership in innovative government business applications or systems.">

<p>
  Congratulations to Mary Sue Deffily, Program Manager,
  <a href="http://search.usa.gov/program">USASearch Program</a>, GSA for winning the AFFIRM
  Leadership Award for Innovative Applications Presented for superior leadership in innovative
  government business applications or systems.
</p>


    </div>

    <div class='tags'>
      
      <a href="/tagged/research-and-news"><span class="label label-info">research-and-news</span></a>
      
    </div>
  </article>
  
  <article class='article'>
    <div class='time'>
      <a href="/blog/may-release-notes.html">
        <time>June 3, 2011</time>
      </a>
    </div>

    
    <h1>
      <a href="/blog/may-release-notes.html">May Release Notes</a>
    </h1>
    

    <div class='post-content'>
      <p>In the ongoing government effort for transparency, we are going to use our blog to post our release notes on a monthly basis. While they may not be the most exciting posts ever, it seems the logical place to publish our activities. Search, as many know, is difficult with many of the improvements happening behind the scenes.</p>
<p>We divide our work into three categories:</p>
<p>1) Features &#8212; things that you actually notice</p>
<p>2) Bugs &#8212; Fixes to any code issues that may arise </p>
<p>3) Chores &#8212; back-end improvements that you don&#8217;t notice </p>
<p>We did complete a big chore this month by upgrading to Rails 3 which will be invisible to you, but it will bring additional stability for our search environment and allow us to have longer feature list in the coming months.</p>
<p><strong>New/Enhanced Features:</strong></p>
<ul><li>Searchers see new second-level top navigation on landing pages and SERPs on <a href="http://Search.USA.gov">Search.USA.gov</a> and <a href="http://search.usa.gov/?locale=es">Buscador.USA.gov</a></li>
<li>Spanish searchers see improved <a href="http://search.usa.gov/?locale=es">web</a> and <a href="http://search.usa.gov/images?locale=es&amp;m=false">image</a> landing pages</li>
<li>Spanish searchers see brown color scheme</li>
<li>Visitors sees <a href="http://www.usa.gov">USA.gov</a>-branded search box on all pages</li>
<li>Searchers see updated affiliate and mobile type-ahead search suggestions</li>
<li>Mobile visitors can see SMS option on <a href="http://search.usa.gov/?locale=en&amp;m=true">m.USA.gov</a></li>
<li><span>Searchers see updated affiliate and mobile pages</span><span> </span></li>
</ul><p><strong>Bugs:</strong></p>
<ul><li>Fixed bugs/display problems with monthly clicks/queries</li>
<li>Inconsistent autocomplete on images landing page and image SERPs</li>
<li>Spanish searchers see updated text on Buscador.USA.gov <a href="http://search.usa.gov/search/advanced?locale=es&amp;m=false">advanced search page</a></li>
</ul><p><strong>Chores:</strong></p>
<ul><li>Upgraded to Rails 3 &#8212; the chore list would be long, but let us know if anyone is interested in hearing about the upgrade</li>
</ul><p><em>By Erik</em></p>

    </div>

    <div class='tags'>
      
      <a href="/tagged/releases"><span class="label label-info">releases</span></a>
      
    </div>
  </article>
  
  <article class='article'>
    <div class='time'>
      <a href="/blog/spotlight-broward-county-florida.html">
        <time>May 24, 2011</time>
      </a>
    </div>

    
    <h1>
      <a href="/blog/spotlight-broward-county-florida.html">Spotlight: Broward County, Florida</a>
    </h1>
    

    <div class='post-content'>
      <p>While USASearch is for all levels of government (federal, state, local, tribal, and territorial), most of our customers come from the federal sector. So, we are showcasing a highly-trafficked county site to show how other levels of government successfully leverage our site search service.</p>
<p><a href="http://www.broward.org" target="_blank">Broward County, Florida</a> has a popular web site that serves thousands of multi-lingual users from the Miami metropolitan area. </p>
<p><img class="img-polaroid" class="img-polaroid" alt="Image of the Broward.org homepage" src="http://f22818b4dfc10241d8a3-f1564c64756a8cfee25b6b19953b1d23.r31.cf2.rackcdn.com/tumblr_lloa7zX9zz1qid15q.png"/></p>
<p>We want to thank Rob Nadeau (Web Site Manager for Broward County) for being a good and supportive customer and someone who proactively implements our special features!</p>
<p>Rob offered these kind words about USASearch.</p>
<blockquote>
<p>When USASearch expanded their affiliate program, <a href="http://www.broward.org" target="_blank">Broward County</a> was fortunate to be the first County in the nation to participate in the effort. During times when budgets are limited, the partnership monetarily saved the County by not moving to a commercial search solution. As the program evolved to &#8220;new&#8221; technology and tools, the County and our visitors once again benefited from an ever-growing feature rich program that now offers a more accurate search with speed 9 times faster.</p>
<ul><li>a customized look and feel</li>
<li>the ability to immediately boost content to showcase specific pages to appear above the main results</li>
<li>type-ahead search suggestions for visitors to our site</li>
<li>the ability to add and remove search suggestions</li>
<li>the ability to generate reports</li>
</ul><p>Thank you for a program that keeps on giving.</p>
</blockquote>
<p>Thank you, Rob, and everyone please help us spread the word about USASearch to all levels of government.</p>

    </div>

    <div class='tags'>
      
      <a href="/tagged/testimonial"><span class="label label-info">testimonial</span></a>
      
    </div>
  </article>
  
</div>

<ul class="pager">
  
  <li class="previous">
    
    <a href="/blog/page9">&larr; Newer</a>
    
  </li>
  

  

</ul>
<!-- end paginate layout -->
  </div>
</div>

<footer class="footer">
  <div class="container">
    <ul class="footer-links unstyled inline">
      <li><a href="/tos.html">Terms of Service</a></li>
      <li class="muted">&bull;</li>
      <li><a href="http://www.twitter.com/usasearch">Follow Us on Twitter</a></li>
      <li class="muted">&bull;</li>
      <li><a href="mailto:usasearch@gsa.gov">USASearch@gsa.gov</a></li>
      <li><i class="icon-phone"></i>&nbsp;202-505-5315</li>
    </ul>
    <p> An Official Website of the U.S. Government </p>
    <p>
      Sponsored by GSA's <a href="http://www.gsa.gov/portal/category/25729">Office of Citizen
      Services &amp; Innovative Technologies</a>
    </p>
    <ul class="footer-links unstyled inline">
      <li>
        <a href="http://www.gsa.gov">
          <img src="http://c566677.r77.cf2.rackcdn.com/logo_footer_gsa.png"
               alt="GSA.gov logo" id="gsa-logo"></a>
      </li>
      <li>
        <a href="http://www.howto.gov">
        <img src="http://f22818b4dfc10241d8a3-f1564c64756a8cfee25b6b19953b1d23.r31.cf2.rackcdn.com/footer_htlogo.png"
             alt="HowTo.gov logo" id="howto-logo"></a>
      </li>
      <li>
        <a href="http://www.usa.gov">
          <img src="http://c566677.r77.cf2.rackcdn.com/logo_footer_usaGov.png"
               alt="USA.gov logo" id="usagov-logo"></a>
      </li>
    </ul>
  </div>
</footer>

<script type="text/javascript">
  //<![CDATA[
  var usasearch_config = { siteHandle:"usasearch" };

  var script = document.createElement("script");
  script.type = "text/javascript";
  script.src = "http://search.usa.gov/javascripts/remote.loader.js";
  document.getElementsByTagName("head")[0].appendChild(script);

  //]]>
</script>

</body>
</html>