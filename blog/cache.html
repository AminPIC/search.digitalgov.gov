<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Cache Me If You Can</title>
  <meta name="description" content="">
  <meta name="author" content="">

  <link href="/bootstrap/css/bootstrap.css" rel="stylesheet">
  <link rel="stylesheet" href="/stylesheets/font-awesome.min.css">
  <!--[if IE 7]>
  <link rel="stylesheet" href="/stylesheets/font-awesome-ie7.min.css">
  <![endif]-->

  <style>
    body {
      padding-top: 60px;
    }
  </style>
  <!--<link href="../assets/css/bootstrap-responsive.css" rel="stylesheet">-->
  <link href="/stylesheets/custom.css" rel="stylesheet">

  <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
  <!--[if lt IE 9]>
  <script src="/javascripts/html5shiv.js"></script>
  <![endif]-->

  <!-- Fav and touch icons -->
  <!--  <link rel="apple-touch-icon-precomposed" sizes="144x144"
          href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114"
          href="../assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72"
          href="../assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">-->
  <link rel="shortcut icon" href="https://9fddeb862c037f6d2190-f1564c64756a8cfee25b6b19953b1d23.ssl.cf2.rackcdn.com/favicon.ico">
  <link rel='alternate' type='application/atom+xml' title='usasearch.howto.gov Atom feed' href='/all.atom' />
</head>
<body>
<div class="navbar navbar-inverse navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="/"><span class="usa">USA</span><span class="search">Search</span></a>
      <ul class="nav">
        <li><a href="/help-desk.html">How It Works</a></li>
        <li><a href="/customers.html">Our Customers</a></li>
      </ul>
      <ul class="nav">
        <li>
          <form class="form-search" accept-charset="UTF-8" action="http://search.howto.gov/search/news/" id="search-form" method="get">
            <input id="affiliate" name="affiliate" type="hidden" value="usasearch"/>
            <input type="hidden" name="channel" value="1745">
            <input type="hidden" name="sort_by" value="r">
            <div class="input-append">
              <label for="search-query" class="hide">Query</label>
              <input name="query" type="text" autocomplete="off"
                     class="usagov-search-autocomplete span search-query" id="search-query"/>
              <input type="submit" class="btn" id="search-button" value="Search" />
            </div>
          </form>
        </li>
      </ul>
      <ul class="nav login">
        <li>
          <a href="https://search.usa.gov/sites"><i
              class="icon-user icon-white"></i>&nbsp;Login</a>
        </li>
      </ul>
    </div>
  </div>
</div>


<div class="container">
  <div id="main-container"><article class="article">
  <div class='time'>
    
    <a href="/blog/cache.html">
      <time>November 12, 2013</time>
    </a>
  </div>

  
  <h1>
    <a href="/blog/cache.html">Cache Me If You Can</a>
  </h1>
  

  <div class='post-content'>
    <h2>Speed Is Important</h2>

<p>Speed is the primary factor in determining customers' satisfaction with search results. If searchers think that a results page isn't loading quickly enough, they'll hit the back button and abandon their search before they even see if the results are relevant.</p>

<p>Google's <a href="https://www.google.com/search?q=Google+Gospel+of+Speed">Gospel of Speed</a> <img src="https://9fddeb862c037f6d2190-f1564c64756a8cfee25b6b19953b1d23.ssl.cf2.rackcdn.com/external_link.gif" alt="External link" /> motto laid the foundation for the company's success. The need for speed is now extending beyond search and into all web sites and applications as <a href="http://www.nytimes.com/2012/03/01/technology/impatient-web-users-flee-slow-loading-sites.html">web users expect results in the blink of an eye</a> <img src="https://9fddeb862c037f6d2190-f1564c64756a8cfee25b6b19953b1d23.ssl.cf2.rackcdn.com/external_link.gif" alt="External link" />.</p>

<h2>We Focus on Speed</h2>

<p>When we established our service's new open source architecture in 2010, we first tackled how to deliver our results in under one second. At around the same time, <a href="http://www.github.com">Github</a> <img src="https://9fddeb862c037f6d2190-f1564c64756a8cfee25b6b19953b1d23.ssl.cf2.rackcdn.com/external_link.gif" alt="External link" /> was experiencing exponential growth and the company's engineers were blogging about what they did to make Github fast. To get up to speed quickly (yes, bad pun intended), we read their posts.</p>

<ul>
<li><p><a href="https://github.com/blog/530-how-we-made-github-fast">How We Made GitHub Fast</a> <img src="https://9fddeb862c037f6d2190-f1564c64756a8cfee25b6b19953b1d23.ssl.cf2.rackcdn.com/external_link.gif" alt="External link" />, October 20, 2009</p></li>
<li><p><a href="https://github.com/blog/1252-how-we-keep-github-fast">How We Keep GitHub Fast</a> <img src="https://9fddeb862c037f6d2190-f1564c64756a8cfee25b6b19953b1d23.ssl.cf2.rackcdn.com/external_link.gif" alt="External link" />, September 5, 2012</p></li>
</ul>


<p>Leveraging some of their tips, we architected a service that succeeded in delivering our results in under 700 milliseconds, on average&mdash;a significant improvement from the previous vendor-owned and -operated iterations of our service.</p>

<p>Over the past three years, we've dug in and improved our response time. We now deliver our results in under 500 milliseconds, on average.</p>

<p>We already had an architecture optimized for speed. So, how did we speed it up by 200 milliseconds?</p>

<h2>We Use Cache to Lower Latency</h2>

<p>In a nutshell, speed = low latency + high bandwidth.</p>

<p><a href="http://www.igvita.com/2012/07/19/latency-the-new-web-performance-bottleneck/">Latency</a> <img src="https://9fddeb862c037f6d2190-f1564c64756a8cfee25b6b19953b1d23.ssl.cf2.rackcdn.com/external_link.gif" alt="External link" /> is delay. It is the amount of time it takes a packet of information to travel from our servers to a searcher's web browser. In our quest to shave precious milliseconds off of our response time, we've spent much of our time focused on the latency side of the equation.</p>

<p>Caching is a key strategy that we use to lower our latency. Within each logical component of our system (as shown in the diagram below), we ask ourselves, "How we can make <em>this</em> faster?"</p>

<p><img src="https://9fddeb862c037f6d2190-f1564c64756a8cfee25b6b19953b1d23.ssl.cf2.rackcdn.com/cache.png" alt="Logical system components" /></p>

<h3>Optimizing Our Software Stack</h3>

<p><a href="https://github.com/resque">Resque</a> <img src="https://9fddeb862c037f6d2190-f1564c64756a8cfee25b6b19953b1d23.ssl.cf2.rackcdn.com/external_link.gif" alt="External link" /> serves as our first line of defense to help us reduce our latency. Resque is a <a href="http://redis.io/">Redis</a>-backed  <img src="https://9fddeb862c037f6d2190-f1564c64756a8cfee25b6b19953b1d23.ssl.cf2.rackcdn.com/external_link.gif" alt="External link" /> Ruby library that allows us to store our various objects and datasets without searchers ever having to access our system's components. Read <a href="https://github.com/blog/542-introducing-resque"><em>Introducing Resque</em></a> <img src="https://9fddeb862c037f6d2190-f1564c64756a8cfee25b6b19953b1d23.ssl.cf2.rackcdn.com/external_link.gif" alt="External link" /> to learn more about how it works.</p>

<p>Moving down through our software stack, we also monitor and preprocess popular requests to our <a href="http://www.mysql.com/">MySQL</a> <img src="https://9fddeb862c037f6d2190-f1564c64756a8cfee25b6b19953b1d23.ssl.cf2.rackcdn.com/external_link.gif" alt="External link" /> database. For example, most of our agency customers view their <a href="/sites/manual/monthly-report.html">Monthly Report</a> within the first fews days of the month. Generating these reports "on the fly" during this relatively short window could strain our system. So, instead, we generate static monthly reports outside of core business hours. This preprocessing speeds up searchers' experience on our results pages plus it saves us money because we don't need extra servers to meet the burst in demand.</p>

<h3>Using a Content Delivery Network</h3>

<p>Our static content (such as javascripts and sytlesheets) gets served through our <a href="http://www.webopedia.com/TERM/C/CDN.html">content delivery network</a> <img src="https://9fddeb862c037f6d2190-f1564c64756a8cfee25b6b19953b1d23.ssl.cf2.rackcdn.com/external_link.gif" alt="External link" /> provider, currently Akamai. Akamai serves our static content from its server that is geographically closest to the searcher. The closer, the faster.</p>

<p>Using a content delivery network also allow us to optimize our service's speed by:</p>

<ul>
<li>Directing non-cached traffic between our two datacenters to create a <a href="/releases/2012-10-19.html">multihomed environment</a>. Multihoming allows us to make full use of all of our servers. By contrast, in 2010, our disaster recovery datacenter often sat idle.</li>
<li>Reducing our need to add bandwidth or servers to handle short-term traffic spurts, such as spurts related to natural disasters.</li>
<li>Protecting against denial of service attacks by spotting them before they reach our servers.</li>
</ul>


<h2>What's Next?</h2>

<p>While the 10,000 foot view of our architecture today looks similar to our architecture in 2010, we've worked hard over the past three years to speed up the delivery of our results by optimizing each link in the chain.</p>

<p>We use several monitoring tools to measure our system's performance. The quality of these tools is improving at a rapid pace, which in turn, shows us where and how we can improve our service.</p>

<p>We regularly ask ourselves, "Will <em>this</em> shave some time off and help us deliver our results in <em>under</em> 500 milliseconds?"</p>

  </div>

  <div class='tags'>
    
    <a href="/tagged/cache"><span class="label label-info">cache</span></a>
    
    <a href="/tagged/architecture"><span class="label label-info">architecture</span></a>
    
    <a href="/tagged/about-us"><span class="label label-info">about-us</span></a>
    
  </div>
</article></div>
</div>

<footer class="footer">
  <div class="container">
    <ul class="footer-links unstyled inline">
      <li><a href="/developer/index.html">APIs</a></li>
      <li class="muted">&bull;</li>
      <li><i class="icon-twitter"></i>&nbsp;<a href="http://www.twitter.com/usasearch">@USASearch</a></li>
      <li class="muted">&bull;</li>
      <li><i class="icon-envelope"></i>&nbsp;<a href="mailto:usasearch@gsa.gov">USASearch@gsa.gov</a></li>
      <li class="muted">&bull;</li>
      <li><i class="icon-phone"></i>&nbsp;202-505-5315</li>
      <li class="muted">&bull;</li>
      <li><a href="/tos.html">Terms of Service</a></li>      
    </ul>
    <p> An Official Website of the U.S. Government <br />
      Sponsored by GSA's <a href="http://www.gsa.gov/portal/category/25729">Office of Citizen
      Services &amp; Innovative Technologies</a>
    </p>
    <ul class="footer-links unstyled inline">
      <li>
        <a href="http://www.gsa.gov">
          <img src="http://c566677.r77.cf2.rackcdn.com/logo_footer_gsa.png"
               alt="GSA.gov logo" id="gsa-logo"></a>
      </li>
      <li>
        <a href="http://www.howto.gov">
        <img src="https://9fddeb862c037f6d2190-f1564c64756a8cfee25b6b19953b1d23.ssl.cf2.rackcdn.com/footer_htlogo.png"
             alt="HowTo.gov logo" id="howto-logo"></a>
      </li>
      <li>
        <a href="http://www.usa.gov">
          <img src="http://c566677.r77.cf2.rackcdn.com/logo_footer_usaGov.png"
               alt="USA.gov logo" id="usagov-logo"></a>
      </li>
    </ul>
  </div>
</footer>

<script type="text/javascript">
  //<![CDATA[
  var usasearch_config = { siteHandle:"usasearch" };

  var script = document.createElement("script");
  script.type = "text/javascript";
  script.src = "http://search.usa.gov/javascripts/remote.loader.js";
  document.getElementsByTagName("head")[0].appendChild(script);

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-31302465-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
  //]]>
</script>


</body>
</html>
